---
// src/pages/index.astro
import BaseLayout from "../layouts/BaseLayout.astro";
import ProductCard from "../components/ProductCard.astro";
import Carousel from "../components/Carousel.astro";
import NewProducts from "../components/NewProducts.jsx";
import apiClient from "../api/apiClient.jsx";

// Fetch only the featured products at build time
let featured = [];
try {
  const data = await apiClient.products.getPage(0, 8);
  featured = data.content || [];
} catch (err) {
  console.error("Featured products could not be fetched:", err);
  featured = [];
}
---

<BaseLayout title="ÐÒ¯Ò¯Ñ€ Ñ…ÑƒÑƒÐ´Ð°Ñ">
Â  Â  <div class="px-[3%] py-3 2xl:px-[8%]">
Â  Â  Â  Â  <!-- ÐžÐ´Ð¾Ð¾ Ð±Ð°Ð¹Ð³Ð°Ð° ÐºÐ°Ñ€ÑƒÑÐµÐ»ÑŒ -->
Â  Â  Â  Â  <Carousel />
Â  Â  </div>

Â  Â  <section class="max-w-7xl mx-auto px-6 lg:px-8">
Â  Â  Â  Â  <!-- ðŸŽ Ð¨Ð¸Ð½Ñ Ð±Ð°Ð½Ð½ÐµÑ€: ÐžÐ½Ñ†Ð³Ð¾Ð¹ ÑƒÑ€Ð°Ð¼ÑˆÑƒÑƒÐ»Ð°Ð» -->
Â  Â  Â  Â  <div class="my-8">
Â  Â  Â  Â  Â  Â  <a href="/sales" class="block">
Â  Â  Â  Â  Â  Â  Â  Â  <img src="https://placehold.co/1200x250/003375/ffffff?text=ÐžÐ½Ñ†Ð³Ð¾Ð¹+Ð¥ÑÐ¼Ð´Ñ€Ð°Ð»+Ð±Ð°+Ð£Ñ€Ð°Ð¼ÑˆÑƒÑƒÐ»Ð°Ð»" alt="ÐžÐ½Ñ†Ð³Ð¾Ð¹ Ñ…ÑÐ¼Ð´Ñ€Ð°Ð»" class="w-full h-auto rounded-2xl shadow-lg transition-transform hover:scale-[1.01] duration-300" />
Â  Â  Â  Â  Â  Â  </a>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <!-- Featured row -->
Â  Â  Â  Â  <div class="mt-6">
Â  Â  Â  Â  Â  Â  <div class="flex items-center gap-2 text-gray-700 mb-3">
Â  Â  Â  Â  Â  Â  Â  Â  <span class="h-3 w-3 rounded-full bg-[#003375]"></span>
Â  Â  Â  Â  Â  Â  Â  Â  <h2 class="text-xl font-semibold">ÐžÐ½Ñ†Ð»Ð¾Ñ…</h2>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 xl:grid-cols-4 gap-4">
Â  Â  Â  Â  Â  Â  Â  Â  {featured.map((p: any) => (
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <ProductCard product={p} />
Â  Â  Â  Â  Â  Â  Â  Â  ))}
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <!-- ðŸŽ Ð¨Ð¸Ð½Ñ Ð¶Ð¸Ð¶Ð¸Ð³ Ð±Ð°Ð½Ð½ÐµÑ€: Ò®Ð½ÑÐ³Ò¯Ð¹ Ñ…Ò¯Ñ€Ð³ÑÐ»Ñ‚ -->
Â  Â  Â  Â  <div class="my-8">
Â  Â  Â  Â  Â  Â  <a href="/delivery" class="block">
Â  Â  Â  Â  Â  Â  Â  Â  <img src="https://placehold.co/1200x120/f7941e/ffffff?text=100'000+â‚®-Ñ+Ð´ÑÑÑˆ+Ñ…ÑƒÐ´Ð°Ð»Ð´Ð°Ð½+Ð°Ð²Ð°Ð»Ñ‚Ð°Ð´+Ò¯Ð½ÑÐ³Ò¯Ð¹+Ñ…Ò¯Ñ€Ð³ÑÐ»Ñ‚" alt="Ò®Ð½ÑÐ³Ò¯Ð¹ Ñ…Ò¯Ñ€Ð³ÑÐ»Ñ‚" class="w-full h-auto rounded-xl shadow-md transition-transform hover:scale-[1.01] duration-300" />
Â  Â  Â  Â  Â  Â  </a>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <!-- All products grid now uses the new component -->
        <NewProducts client:load />
Â  Â  </section>
</BaseLayout>
